<div align="center">

# ğŸ¤– ChatterBot

**Discordã§è‡ªç„¶ã«ä¼šè©±ã«å‚åŠ ã™ã‚‹ã€ã¡ã‚‡ã£ã¨ä¾¿åˆ©ãªãƒãƒ£ãƒƒãƒˆä»²é–“**

[![.NET](https://img.shields.io/badge/.NET-10.0-512BD4?style=for-the-badge&logo=dotnet)](https://dotnet.microsoft.com/)
[![Discord.Net](https://img.shields.io/badge/Discord.Net-3.18.0-5865F2?style=for-the-badge&logo=discord)](https://github.com/RogueException/Discord.Net)
[![Semantic Kernel](https://img.shields.io/badge/Semantic%20Kernel-1.70.0-0078D4?style=for-the-badge&logo=microsoft)](https://github.com/microsoft/semantic-kernel)
[![License](https://img.shields.io/badge/License-MIT-green?style=for-the-badge)](LICENSE)

[English](#english) | **æ—¥æœ¬èª**

</div>

---

## âœ¨ ä½•ãŒã§ãã‚‹ï¼Ÿ

ChatterBot ã¯æ™®é€šã®ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã¨ã¯é•ã„ã¾ã™ã€‚

- ğŸ­ **è‡ªç„¶ãªä¼šè©±å‚åŠ ** - ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ã•ã‚Œãªãã¦ã‚‚ã€é¢ç™½ãã†ãªè©±é¡Œã«ã¯æ¨ªå…¥ã‚Š
- ğŸ§  **æ–‡è„ˆã‚’ç†è§£** - èª°ãŒä½•ã‚’è¨€ã£ãŸã‹æŠŠæ¡ã—ã¦ã€ä¼šè©±ã®æµã‚Œã‚’èª­ã‚€
- ğŸ” **é•·æœŸè¨˜æ†¶** - å…ˆé€±ã®è©±é¡Œã‚‚æ¤œç´¢ã—ã¦ã€Œã‚ã‚Œã©ã†ãªã£ãŸï¼Ÿã€ã«ç­”ãˆã‚‹
- ğŸ› ï¸ **ä¾¿åˆ©ãªæ©Ÿèƒ½** - è¨ˆç®—ã€ã‚µã‚¤ã‚³ãƒ­ã€æ—¥ä»˜è¨ˆç®—ã€URLè¦ç´„ã€ç”»åƒèªè­˜...
- ğŸŒ **ãƒãƒ«ãƒãƒ¢ãƒ‡ãƒ«å¯¾å¿œ** - OpenAIã€GLMã€ãã®ä»–ã®OpenAIäº’æ›API

> ã€Œè¨ˆç®—ã—ã¦ã¿ã‚‹ã­ã€â†’ `56088ã ã£ãŸ` ã¿ãŸã„ã«ã€è‡ªç„¶ã«æ©Ÿèƒ½ã‚’ä½¿ã†æ„Ÿã˜

---

## ğŸ“‹ ç›®æ¬¡

- [ãƒ‡ãƒ¢](#-ãƒ‡ãƒ¢)
- [ç‰¹å¾´](#-ç‰¹å¾´)
- [ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ](#-ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ)
- [è¨­å®š](#%EF%B8%8F-è¨­å®š)
- [æ©Ÿèƒ½ä¸€è¦§](#-æ©Ÿèƒ½ä¸€è¦§)
- [ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](#-ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£)
- [ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º](#%EF%B8%8F-ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º)
- [é–‹ç™º](#-é–‹ç™º)
- [ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ãƒˆ](#-ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ãƒˆ)

---

## ğŸ¬ ãƒ‡ãƒ¢

### è‡ªç„¶ãªä¼šè©±ã¸ã®å‚åŠ 

```
ğŸ‘¤ ç”°ä¸­: ä»Šæ—¥ãƒ©ãƒ¼ãƒ¡ãƒ³é£Ÿã¹ãŸ
ğŸ‘¤ ä½è—¤: ç¾å‘³ã—ã‹ã£ãŸï¼Ÿ
ğŸ‘¤ ç”°ä¸­: ã†ã¾ï¼äºŒéƒç³»ã ã£ãŸ
ğŸ¤– ChatterBot: äºŒéƒã‹ï¼æ¿ƒã„ãªã€œã€å¸°ã‚Šçœ ããªã‚‰ãªã‹ã£ãŸï¼ŸğŸœ
```

### è¨ˆç®—ãƒ»æ—¥ä»˜æ©Ÿèƒ½

```
ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼: 123 * 456ã£ã¦ã„ãã¤ï¼Ÿ
ğŸ¤– ChatterBot: ã¡ã‚‡ã£ã¨è¨ˆç®—ã™ã‚‹ã­
ğŸ¤– ChatterBot: 56088ã ã£ãŸ

ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼: ã‚¯ãƒªã‚¹ãƒã‚¹ã¾ã§ã‚ã¨ä½•æ—¥ï¼Ÿ
ğŸ¤– ChatterBot: 312æ—¥ã‚ã‚‹ã‚ˆã€‚ã¾ã æ—©ã„ã­ğŸ„
```

### éå»ã®è©±é¡Œã‚’æ¤œç´¢

```
ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼: å…ˆé€±ä½•ã®è©±ã—ã¦ãŸã£ã‘ï¼Ÿ
ğŸ¤– ChatterBot: ã†ãƒ¼ã‚“ã€æ€ã„å‡ºã—ã¦ã¿ã‚‹...
ğŸ¤– ChatterBot: ã‚¢ãƒ‹ãƒ¡ã®è©±ã—ã¦ãŸã­ã€‚æ¨ã—ã®å­ã®è©±ãŒç››ã‚Šä¸ŠãŒã£ã¦ãŸ
```

---

## ğŸŒŸ ç‰¹å¾´

<table>
<tr>
<td width="50%">

### ğŸ¯ è‡ªå¾‹çš„ãªè¿”ä¿¡åˆ¤æ–­

AIãŒè‡ªã‚‰ã€Œè¿”ä¿¡ã™ã‚‹ã‹ã©ã†ã‹ã€ã‚’åˆ¤æ–­ã€‚

- é¢ç™½ã„è©±é¡Œ â†’ æ¨ªå…¥ã‚Š
- è³ªå•ã•ã‚Œã¦ã‚‹ â†’ ç­”ãˆã‚‹
- ç‰¹ã«è¨€ã†ã“ã¨ãªã„ â†’ è¦‹ã¦ã‚‹ã ã‘

</td>
<td width="50%">

### ğŸ§  ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰å±¥æ­´ç®¡ç†

2å±¤æ§‹é€ ã§ä¼šè©±ã‚’è¨˜æ†¶ï¼š

- **ChatHistory** - ç›´è¿‘Næ—¥åˆ†ï¼ˆã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆç¶­æŒï¼‰
- **RAGæ¤œç´¢** - å…¨æœŸé–“ï¼ˆæ„å‘³çš„æ¤œç´¢ï¼‰

</td>
</tr>
<tr>
<td width="50%">

### ğŸŒ OpenAIäº’æ›API

æ§˜ã€…ãªAIãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨å¯èƒ½ï¼š

- OpenAI GPT-4o / GPT-4
- GLM (ZhipuAI)
- Azure OpenAI
- ãã®ä»–OpenAIäº’æ›API

</td>
<td width="50%">

### ğŸ  ã‚µãƒ¼ãƒãƒ¼åˆ†é›¢

- ç•°ãªã‚‹ã‚µãƒ¼ãƒãƒ¼ã®å±¥æ­´ã¯å®Œå…¨åˆ†é›¢
- DMã«ã‚‚å¯¾å¿œ
- ãƒãƒ£ãƒ³ãƒãƒ«ã”ã¨ã«ç‹¬ç«‹ã—ãŸä¼šè©±

</td>
</tr>
</table>

---

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### å‰ææ¡ä»¶

- [.NET 10.0 SDK](https://dotnet.microsoft.com/download)
- Discord Bot Token ([å–å¾—æ–¹æ³•](https://discord.com/developers/applications))
- OpenAI API Key ã¾ãŸã¯äº’æ›API

### 1. ã‚¯ãƒ­ãƒ¼ãƒ³

```bash
git clone https://github.com/yourusername/ChatterBot.git
cd ChatterBot
```

### 2. ç’°å¢ƒå¤‰æ•°è¨­å®š

```bash
# Linux/macOS
export DISCORD_BOT_TOKEN="your_discord_token"
export OPENAI_API_KEY="your_api_key"
export OPENAI_MODEL_ID="gpt-4o"

# Windows PowerShell
$env:DISCORD_BOT_TOKEN="your_discord_token"
$env:OPENAI_API_KEY="your_api_key"
$env:OPENAI_MODEL_ID="gpt-4o"
```

### 3. å®Ÿè¡Œ

```bash
cd ChatterBot
dotnet run
```

### ğŸ³ Docker ã§å®Ÿè¡Œ

```bash
docker build -t chatterbot .
docker run -d \
  -e DISCORD_BOT_TOKEN=your_token \
  -e OPENAI_API_KEY=your_key \
  -e OPENAI_MODEL_ID=gpt-4o \
  -v chatterbot-data:/app/data \
  chatterbot
```

---

## âš™ï¸ è¨­å®š

### ç’°å¢ƒå¤‰æ•°ä¸€è¦§

| å¤‰æ•°å | å¿…é ˆ | èª¬æ˜ | ä¾‹ |
|--------|:----:|------|-----|
| `DISCORD_BOT_TOKEN` | âœ… | Discord Bot Token | `MTk4Nj...` |
| `OPENAI_MODEL_ID` | âœ… | ä½¿ç”¨ã™ã‚‹ãƒ¢ãƒ‡ãƒ« | `gpt-4o` |
| `OPENAI_API_KEY` | âœ… | API Key | `sk-...` |
| `OPENAI_ENDPOINT` | | ã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | `https://open.bigmodel.cn/api/paas/v4/` |
| `EMBEDDING_PROVIDER` | | Embeddingãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ | `openai`, `glm`, `none` |
| `EMBEDDING_MODEL_ID` | | Embeddingãƒ¢ãƒ‡ãƒ« | `text-embedding-3-small` |
| `EMBEDDING_API_KEY` | | Embeddingç”¨API Key | |
| `Vision__SupportsVision` | | Visionå¯¾å¿œãƒ•ãƒ©ã‚° | `true`, `false` |
| `VISION_MODEL_ID` | | ç”»åƒèªè­˜ãƒ¢ãƒ‡ãƒ« | `gpt-4o` |
| `VISION_API_KEY` | | ç”»åƒèªè­˜ç”¨API Key | |
| `VISION_ENDPOINT` | | ç”»åƒèªè­˜ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | |

### appsettings.json ã§ã®è¨­å®š

ç’°å¢ƒå¤‰æ•°ã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã‚’ä½¿ç”¨ï¼š

```json
{
  "Discord": {
    "Token": "${DISCORD_BOT_TOKEN}"
  },
  "OpenAI": {
    "ModelId": "${OPENAI_MODEL_ID}",
    "ApiKey": "${OPENAI_API_KEY}",
    "Endpoint": "${OPENAI_ENDPOINT}"
  },
  "Vision": {
    "SupportsVision": false,
    "ModelId": "${VISION_MODEL_ID}",
    "ApiKey": "${VISION_API_KEY}",
    "Endpoint": "${VISION_ENDPOINT}"
  },
  "Embedding": {
    "Provider": "${EMBEDDING_PROVIDER}",
    "ModelId": "${EMBEDDING_MODEL_ID}",
    "ApiKey": "${EMBEDDING_API_KEY}",
    "Endpoint": "${EMBEDDING_ENDPOINT}"
  },
  "Database": {
    "Path": "data/chatterbot.db"
  },
  "History": {
    "ChatHistoryMaxMessages": 30,
    "RagSearchLimit": 5,
    "DefaultLoadDays": 7
  }
}
```

### GLM (ZhipuAI) ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆ

```bash
export OPENAI_MODEL_ID="glm-4-plus"
export OPENAI_API_KEY="your_glm_api_key"
export OPENAI_ENDPOINT="https://open.bigmodel.cn/api/paas/v4/"

export EMBEDDING_PROVIDER="glm"
export EMBEDDING_MODEL_ID="embedding-3"
export EMBEDDING_API_KEY="your_glm_api_key"
export EMBEDDING_ENDPOINT="https://open.bigmodel.cn/api/paas/v4/"
```

### ç”»åƒèªè­˜è¨­å®š

`SupportsVision` ã®è¨­å®šã«ã‚ˆã‚Šç”»åƒå‡¦ç†æ–¹æ³•ãŒå¤‰ã‚ã‚Šã¾ã™ï¼š

| `SupportsVision` | Visionè¨­å®š | ç”»åƒå‡¦ç† | `describe_image` tool |
|:----------------:|:----------:|:--------:|:---------------------:|
| `true` | ä¸è¦ | ç”»åƒã‚’ç›´æ¥èªè­˜ | âŒ ç„¡åŠ¹ |
| `false` | ã‚ã‚Š | URLã‚’æ¸¡ã™ã€LLMåˆ¤æ–­ã§toolä½¿ç”¨ | âœ… æœ‰åŠ¹ |
| `false` | ãªã— | å®Œå…¨ã«ç„¡è¦– | âŒ ç„¡åŠ¹ |

**ãƒ‘ã‚¿ãƒ¼ãƒ³1: Visionå¯¾å¿œãƒ¢ãƒ‡ãƒ«ï¼ˆGPT-4oç­‰ï¼‰**
```json
{
  "OpenAI": { "ModelId": "gpt-4o" },
  "Vision": { "SupportsVision": true }
}
```

**ãƒ‘ã‚¿ãƒ¼ãƒ³2: Visionéå¯¾å¿œ + åˆ¥é€”Vision API**
```json
{
  "OpenAI": { "ModelId": "glm-4-flash" },
  "Vision": {
    "SupportsVision": false,
    "ModelId": "glm-4v",
    "ApiKey": "your_vision_api_key",
    "Endpoint": "https://open.bigmodel.cn/api/paas/v4/"
  }
}
```

**ãƒ‘ã‚¿ãƒ¼ãƒ³3: ç”»åƒæ©Ÿèƒ½ãªã—**
```json
{
  "OpenAI": { "ModelId": "gpt-4" },
  "Vision": { "SupportsVision": false }
}
```

---

## ğŸ› ï¸ æ©Ÿèƒ½ä¸€è¦§

BotãŒä½¿ç”¨ã§ãã‚‹æ©Ÿèƒ½ï¼ˆSemantic Kernel Function Callingï¼‰ï¼š

### ğŸ“ è¿”ä¿¡åˆ¶å¾¡

| é–¢æ•° | èª¬æ˜ |
|------|------|
| `reply(content)` | è¿”ä¿¡ã™ã‚‹ |
| `do_not_reply()` | è¿”ä¿¡ã—ãªã„ï¼ˆè¦‹ã¦ã‚‹ã ã‘ï¼‰ |

### ğŸ” å±¥æ­´æ¤œç´¢

| é–¢æ•° | èª¬æ˜ |
|------|------|
| `search_history(query)` | éå»ã®ä¼šè©±ã‚’æ¤œç´¢ |

### ğŸ“… æ—¥ä»˜ãƒ»æ™‚åˆ»

| é–¢æ•° | èª¬æ˜ | ä½¿ç”¨ä¾‹ |
|------|------|--------|
| `get_time()` | ç¾åœ¨æ™‚åˆ» | `14:30` |
| `get_date()` | ä»Šæ—¥ã®æ—¥ä»˜ | `2024-01-15, Monday` |
| `get_current_time()` | æ—¥æ™‚ã™ã¹ã¦ | |
| `days_until(target)` | æŒ‡å®šæ—¥ã¾ã§ã®æ—¥æ•° | `christmas`, `newyear`, `tomorrow` |
| `add_days(days)` | Næ—¥å¾Œã®æ—¥ä»˜ | |
| `days_between(start, end)` | æ—¥ä»˜é–“ã®æ—¥æ•° | |
| `day_of_week(date)` | æ›œæ—¥ã‚’å–å¾— | |

### ğŸ”¢ è¨ˆç®—

| é–¢æ•° | èª¬æ˜ |
|------|------|
| `add(a, b)` | è¶³ã—ç®— |
| `subtract(a, b)` | å¼•ãç®— |
| `multiply(a, b)` | æ›ã‘ç®— |
| `divide(a, b)` | å‰²ã‚Šç®— |
| `sqrt(x)` | å¹³æ–¹æ ¹ |
| `pow(x, y)` | ç´¯ä¹— |
| `abs(x)` | çµ¶å¯¾å€¤ |
| `round(x)`, `floor(x)`, `ceil(x)` | ä¸¸ã‚ |
| `compare(a, b)` | å¤§å°æ¯”è¼ƒ |

### ğŸ“ ä¸‰è§’é–¢æ•°

| é–¢æ•° | èª¬æ˜ |
|------|------|
| `sin`, `cos`, `tan` | ä¸‰è§’é–¢æ•° |
| `asin`, `acos`, `atan` | é€†ä¸‰è§’é–¢æ•° |
| `pi()`, `e()` | å®šæ•° |

### ğŸ² ãƒ©ãƒ³ãƒ€ãƒ 

| é–¢æ•° | èª¬æ˜ | ä½¿ç”¨ä¾‹ |
|------|------|--------|
| `roll_dice(notation)` | ã‚µã‚¤ã‚³ãƒ­ | `1d6`, `2d10`, `3d6+2` |
| `coin_flip()` | ã‚³ã‚¤ãƒ³ãƒˆã‚¹ | `è¡¨` / `è£` |
| `pick_one(items)` | ãƒªã‚¹ãƒˆã‹ã‚‰é¸ã¶ | `ã‚¢ã‚¤ã‚¹,ã‚±ãƒ¼ã‚­,ãƒãƒ§ã‚³` |
| `shuffle(items)` | ã‚·ãƒ£ãƒƒãƒ•ãƒ« | |
| `random_number(min, max)` | ãƒ©ãƒ³ãƒ€ãƒ æ•°å€¤ | |

### ğŸŒ å¤–éƒ¨ãƒ‡ãƒ¼ã‚¿

| é–¢æ•° | èª¬æ˜ |
|------|------|
| `read_url(url)` | URLã®å†…å®¹ã‚’èª­ã¿è¾¼ã‚€ |
| `describe_image(url)` | ç”»åƒã®å†…å®¹ã‚’èª¬æ˜ï¼ˆLLMåˆ¤æ–­ã§å‘¼ã³å‡ºã—ï¼‰ |

---

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Discord Gateway                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      DiscordBotService                          â”‚
â”‚  â€¢ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å—ä¿¡                                                â”‚
â”‚  â€¢ ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼ˆãƒ¡ãƒ³ã‚·ãƒ§ãƒ³å¤‰æ›ç”¨ï¼‰                         â”‚
â”‚  â€¢ @username / xxxã•ã‚“ â†’ Discordãƒ¡ãƒ³ã‚·ãƒ§ãƒ³å¤‰æ›                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 SemanticKernelMessageProcessor                  â”‚
â”‚                         (IMessageProcessor)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â–¼               â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ChatHistoryManagerâ”‚ â”‚RagHistoryStore â”‚ â”‚     Plugins        â”‚
â”‚   (ç›´è¿‘Næ—¥åˆ†)     â”‚ â”‚  (å…¨æœŸé–“+åŸ‹è¾¼)  â”‚ â”‚  (Function Calling) â”‚
â”‚                  â”‚ â”‚                â”‚ â”‚                    â”‚
â”‚  â€¢ ãƒ¡ãƒ¢ãƒªä¸Šã®å±¥æ­´ â”‚ â”‚  â€¢ SQLite      â”‚ â”‚  â€¢ ReplyPlugin     â”‚
â”‚  â€¢ èª°ãŒç™ºè¨€ã—ãŸã‹ â”‚ â”‚  â€¢ Embedding   â”‚ â”‚  â€¢ TimePlugin      â”‚
â”‚    ã‚’ä¿æŒ        â”‚ â”‚  â€¢ ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢ â”‚ â”‚  â€¢ MathPlugin      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â€¢ RandomPlugin    â”‚
                                        â”‚  â€¢ UrlReaderPlugin â”‚
                                        â”‚  â€¢ ImageReader     â”‚
                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Semantic Kernel + AI Model                   â”‚
â”‚           (OpenAI / GLM / Azure OpenAI / etc.)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹æˆ

```sql
CREATE TABLE chat_messages (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    guild_id INTEGER,           -- ã‚µãƒ¼ãƒãƒ¼ID (DM ã®å ´åˆã¯ NULL)
    channel_id INTEGER NOT NULL,
    user_id INTEGER NOT NULL,
    user_name TEXT NOT NULL,    -- ç™ºè¨€è€…å
    role TEXT NOT NULL,         -- 'user' or 'assistant'
    content TEXT NOT NULL,
    embedding BLOB,             -- RAGç”¨ãƒ™ã‚¯ãƒˆãƒ« (NULLå¯èƒ½)
    created_at TEXT NOT NULL
);
```

---

## ğŸ¨ ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

### ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®å¤‰æ›´

`appsettings.json` ã® `SystemPrompt` ã‚’ç·¨é›†ï¼š

```json
{
  "SystemPrompt": "ChatterBotã ã‚ˆã€‚Discordã§ã¿ã‚“ãªã¨å–‹ã£ã¦ã‚‹ã ã‘ã®æ™®é€šã®äººé–“..."
}
```

### å±¥æ­´è¨­å®š

```json
{
  "History": {
    "ChatHistoryMaxMessages": 30,   // ç›´è¿‘ä½•ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä¿æŒ
    "RagSearchLimit": 5,            // RAGæ¤œç´¢ã®æœ€å¤§ä»¶æ•°
    "DefaultLoadDays": 7,           // èµ·å‹•æ™‚ã«ä½•æ—¥åˆ†èª­ã¿è¾¼ã‚€ã‹
    "InactiveDaysThreshold": 30     // éã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒãƒ£ãƒ³ãƒãƒ«åˆ¤å®š
  }
}
```

### ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®è¿½åŠ 

1. `ChatterBot.Plugins` åå‰ç©ºé–“ã«æ–°ã—ã„ã‚¯ãƒ©ã‚¹ã‚’ä½œæˆ
2. `[KernelFunction]` å±æ€§ã§é–¢æ•°ã‚’å®šç¾©
3. `SemanticKernelMessageProcessor.cs` ã§ç™»éŒ²

```csharp
// ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ä¾‹
public class WeatherPlugin
{
    [KernelFunction("get_weather")]
    [Description("æŒ‡å®šã—ãŸéƒ½å¸‚ã®å¤©æ°—ã‚’å–å¾—ã—ã¾ã™")]
    public async Task<string> GetWeather(string city)
    {
        // å®Ÿè£…
    }
}

// ç™»éŒ²
pluginKernel.Plugins.Add(
    KernelPluginFactory.CreateFromObject(new WeatherPlugin(), "WeatherPlugin"));
```

---

## ğŸ’» é–‹ç™º

### ãƒ“ãƒ«ãƒ‰

```bash
dotnet build
```

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

```
ChatterBot/
â”œâ”€â”€ Program.cs                    # ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”œâ”€â”€ appsettings.json              # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ ChatterBot.csproj            # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå®šç¾©
â”‚
â”œâ”€â”€ Abstractions/
â”‚   â”œâ”€â”€ IMessageProcessor.cs     # ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‡¦ç†ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
â”‚   â”œâ”€â”€ IChatHistoryManager.cs   # ãƒãƒ£ãƒƒãƒˆå±¥æ­´ç®¡ç†
â”‚   â”œâ”€â”€ IRagHistoryStore.cs      # RAGã‚¹ãƒˆã‚¢
â”‚   â””â”€â”€ Models.cs                # ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«
â”‚
â”œâ”€â”€ Plugins/
â”‚   â”œâ”€â”€ ReplyPlugin.cs           # è¿”ä¿¡åˆ¶å¾¡
â”‚   â”œâ”€â”€ HistorySearchPlugin.cs   # å±¥æ­´æ¤œç´¢
â”‚   â”œâ”€â”€ TimePlugin.cs            # æ—¥ä»˜ãƒ»æ™‚åˆ»
â”‚   â”œâ”€â”€ MathPlugin.cs            # è¨ˆç®—ãƒ»æ•°å­¦
â”‚   â”œâ”€â”€ RandomPlugin.cs          # ãƒ©ãƒ³ãƒ€ãƒ 
â”‚   â”œâ”€â”€ UrlReaderPlugin.cs       # URLèª­ã¿è¾¼ã¿
â”‚   â””â”€â”€ ImageReaderPlugin.cs     # ç”»åƒèªè­˜
â”‚
â””â”€â”€ Services/
    â”œâ”€â”€ DiscordBotService.cs           # Discordé€£æº
    â”œâ”€â”€ SemanticKernelMessageProcessor.cs  # AIå‡¦ç†
    â”œâ”€â”€ ChatHistoryManager.cs          # å±¥æ­´ç®¡ç†
    â””â”€â”€ SqliteRagHistoryStore.cs       # RAGå®Ÿè£…

ChatterBot.Tests.Console/          # ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ
â”œâ”€â”€ Program.cs                    # ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆèªè­˜ãƒ†ã‚¹ãƒˆ
â”œâ”€â”€ appsettings.json              # ãƒ†ã‚¹ãƒˆç”¨è¨­å®š
â””â”€â”€ SampleHistory.json            # ã‚µãƒ³ãƒ—ãƒ«ä¼šè©±ãƒ‡ãƒ¼ã‚¿
```

### ä½¿ç”¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸

| ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | ç”¨é€” |
|-----------|----------|------|
| Discord.Net | 3.18.0 | Discord Bot |
| Microsoft.SemanticKernel | 1.70.0 | AIçµ±åˆãƒ»Function Calling |
| Microsoft.Extensions.AI | 10.3.0 | Embeddingç”Ÿæˆ |
| Microsoft.Data.Sqlite | 10.0.3 | ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ |

---

## ğŸ§ª ãƒ†ã‚¹ãƒˆ

### ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆèªè­˜ãƒ†ã‚¹ãƒˆ

ä¼šè©±å±¥æ­´ã‹ã‚‰ç›´è¿‘ã®ãƒˆãƒ”ãƒƒã‚¯ã‚’æ­£ã—ãèªè­˜ã§ãã‚‹ã‹ãƒ†ã‚¹ãƒˆã™ã‚‹ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚¢ãƒ—ãƒªã§ã™ã€‚

```bash
cd ChatterBot.Tests.Console

# ç’°å¢ƒå¤‰æ•°è¨­å®š
export OPENAI_MODEL_ID="gpt-4o"
export OPENAI_API_KEY="your_key"
# GLMã®å ´åˆ
# export OPENAI_ENDPOINT="https://open.bigmodel.cn/api/paas/v4/"

# å®Ÿè¡Œ
dotnet run
```

#### ãƒ†ã‚¹ãƒˆå†…å®¹

3ã¤ã®ç•°ãªã‚‹ãƒˆãƒ”ãƒƒã‚¯ã®ä¼šè©±å±¥æ­´ã‚’ç”¨æ„ï¼š
- **ãƒˆãƒ”ãƒƒã‚¯A**: ã‚²ãƒ¼ãƒ ã®è©±ï¼ˆã‚¨ãƒ«ãƒ‡ãƒ³ãƒªãƒ³ã‚°ï¼‰
- **ãƒˆãƒ”ãƒƒã‚¯B**: æ–™ç†ã®è©±ï¼ˆã‚«ãƒ¬ãƒ¼ï¼‰
- **ãƒˆãƒ”ãƒƒã‚¯C**: æ—…è¡Œã®è©±ï¼ˆæ²–ç¸„ï¼‰

æ›–æ˜§ãªè³ªå•ï¼ˆã€Œã§ã€ã©ã†æ€ã†ï¼Ÿã€ã€Œç¶šãã¯ï¼Ÿã€ãªã©ï¼‰ã«å¯¾ã—ã¦ã€ç›´è¿‘ã®ãƒˆãƒ”ãƒƒã‚¯ï¼ˆæ—…è¡Œï¼‰ã«é–¢é€£ã™ã‚‹å¿œç­”ãŒè¿”ã£ã¦ãã‚‹ã‹ã‚’ç¢ºèªã§ãã¾ã™ã€‚

#### ä½¿ã„æ–¹

```
=== ä¼šè©±ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆèªè­˜ãƒ†ã‚¹ãƒˆ ===
ãƒ¢ãƒ‡ãƒ«: gpt-4o
æœ€å¤§å±¥æ­´ä»¶æ•°: 30

--- ãƒ¡ãƒ‹ãƒ¥ãƒ¼ ---
1: ãƒˆãƒ”ãƒƒã‚¯Aã®ã¿ï¼ˆã‚²ãƒ¼ãƒ ã®è©±ï¼‰
2: ãƒˆãƒ”ãƒƒã‚¯A+Bï¼ˆã‚²ãƒ¼ãƒ â†’æ–™ç†ï¼‰
3: ãƒˆãƒ”ãƒƒã‚¯A+B+Cï¼ˆã‚²ãƒ¼ãƒ â†’æ–™ç†â†’æ—…è¡Œï¼‰â˜…æ¨å¥¨
4: ã‚«ã‚¹ã‚¿ãƒ é¸æŠ
q: çµ‚äº†

é¸æŠ: 3
```

ã“ã‚Œã«ã‚ˆã‚Šã€ç•°ãªã‚‹LLMï¼ˆ4B/8B/GLM-4-Flashç­‰ï¼‰ã§ã®ä¼šè©±ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆèªè­˜ç²¾åº¦ã‚’æ¯”è¼ƒã§ãã¾ã™ã€‚

---

## ğŸ¤ ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ãƒˆ

1. Fork ã™ã‚‹
2. Feature ãƒ–ãƒ©ãƒ³ãƒã‚’ä½œæˆ (`git checkout -b feature/amazing`)
3. ã‚³ãƒŸãƒƒãƒˆ (`git commit -m 'Add amazing feature'`)
4. Push (`git push origin feature/amazing`)
5. Pull Request ã‚’ä½œæˆ

---

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ [MIT License](LICENSE) ã®ã‚‚ã¨ã§å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚

---

<div align="center">

**Made with â¤ï¸ by ChatterBot Team**

[â†‘ ãƒˆãƒƒãƒ—ã«æˆ»ã‚‹](#-chatterbot)

</div>

---

<a name="english"></a>
## ğŸ‡ºğŸ‡¸ English

A Discord chatbot that naturally joins conversations. Uses Semantic Kernel + Function Calling where the AI decides whether to reply.

### Quick Start

```bash
# Set environment variables
export DISCORD_BOT_TOKEN="your_token"
export OPENAI_API_KEY="your_key"
export OPENAI_MODEL_ID="gpt-4o"

# Run
dotnet run
```

### Features

- ğŸ­ Natural conversation participation
- ğŸ§  Hybrid history management (ChatHistory + RAG)
- ğŸŒ OpenAI-compatible API support
- ğŸ–¼ï¸ Flexible image handling (direct vision or tool-based)
- ğŸ› ï¸ Rich functions: calculation, time, random, URL reading, image recognition

### Image Handling

| `SupportsVision` | Vision Config | Image Processing | `describe_image` tool |
|:----------------:|:-------------:|:----------------:|:---------------------:|
| `true` | N/A | Direct image recognition | Disabled |
| `false` | Set | URL passed, LLM decides to use tool | Enabled |
| `false` | Not set | Completely ignored | Disabled |

See Japanese section above for detailed documentation.
